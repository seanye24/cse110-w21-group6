(()=>{"use strict";const t=({element:t,...e})=>{const n=document.createElement(t);return Object.entries(e).forEach((([t,e])=>{"innerText"===t||"innerHTML"===t?n[t]=e:n.setAttribute(t,e)})),n};class e extends HTMLElement{static get observedAttributes(){return["title","description"]}constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.styleElement=document.createElement("style"),this.styleElement.innerText="\n      .container {\n        background: lightblue;\n        font-family: Roboto, sans-serif;\n        margin: 1em;\n        padding: 0.5em;\n        position: relative;\n        border-radius: 5px;\n      }\n\n      .title {\n        font-size: 1.25rem;\n      }\n\n      .description {\n        font-size: 1rem;\n        color: darkgray;\n      }\n\n      .task-button {\n        position: absolute;\n        padding: 0.5em;\n        color: rgba(51, 51, 51, 0.5);\n      }\n\n      .task-button:hover {\n        border-radius: 50%;\n        background: rgba(238, 238, 238, 0.5);\n        color: rgba(51, 51, 51, 1);\n        cursor: pointer;\n      }\n\n      #edit-button {\n        display: none;\n      }\n\n      .container:hover > #edit-button {\n        display: initial;\n        top: 0;\n        right: 0;\n      }\n\n      #finish-button {\n        bottom: 0;\n        right: 1.5em;\n      }\n\n      #delete-button {\n        bottom: 0;\n        right: 0;\n      }\n    ",this.materialIconLinkElement=t({element:"link",rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}),this.containerElement=t({element:"div",class:"container"}),this.titleElement=t({element:"h1",class:"title"}),this.descriptionElement=t({element:"h2",class:"description"}),this.editTaskButton=t({element:"span",class:"material-icons task-button",id:"edit-button",innerText:"mode"}),this.finishTaskButton=t({element:"span",class:"material-icons task-button",id:"finish-button",innerText:"done"}),this.deleteTaskButton=t({element:"span",class:"material-icons task-button",id:"delete-button",innerText:"delete"}),this.shadow.append(this.materialIconLinkElement,this.styleElement,this.containerElement),this.containerElement.append(this.titleElement,this.descriptionElement,this.editTaskButton,this.finishTaskButton,this.deleteTaskButton)}attributeChangedCallback(t,e,n){switch(t){case"title":this.titleElement.innerText=n;break;case"description":this.descriptionElement.innerText=n}}}customElements.define("task-item",e);class n extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.styleElement=document.createElement("style"),this.styleElement.innerText="\n      .task-form {\n        margin: 1em;\n        padding: 1em 20%;\n        font-family: Roboto, sans-serif;\n        display: flex;\n        flex-direction: column;\n        border-radius: 5px;\n      }\n\n      .task-input[type='text'] {\n        margin-bottom: 1em;\n        padding: 0.75em;\n        border-radius: 5px;\n        border: 1px solid #777;\n        font-size: 0.9rem;\n        color: #444;\n      }\n\n      .task-input[type='text']:focus {\n        border: 2px solid #0077b6;\n        outline: none;\n        box-shadow: none;\n      }\n\n      .task-input[type='text']::placeholder {\n        color: #777;\n      }\n\n      #submit-input {\n        width: 100%;\n        margin: auto;\n        background: rgba(51, 51, 51, 0.75);\n        border-radius: 5px;\n        outline: none;\n        border: none;\n        color: white;\n        padding: 1em;\n        font-size: 1rem;\n      }\n\n      #submit-input:hover {\n        cursor: pointer;\n        background: rgba(51, 51, 51, 1);\n      }\n    ",this.containerElement=t({element:"form",class:"task-form"}),this.titleInputLabel=t({element:"label",for:"title-input",innerText:"Title"}),this.titleInputElement=t({element:"input",class:"task-input",id:"title-input",type:"text",name:"title",placeholder:"task title"}),this.descriptionInputLabel=t({element:"label",for:"description-input",innerText:"Description"}),this.descriptionInputElement=t({element:"input",class:"task-input",id:"description-input",type:"text",name:"description",placeholder:"task description"}),this.submitInputElement=t({element:"input",class:"task-input",id:"submit-input",type:"submit",value:"Add"}),this.shadow.append(this.styleElement,this.containerElement),this.containerElement.append(this.titleInputLabel,this.titleInputElement,this.descriptionInputLabel,this.descriptionInputElement,this.submitInputElement)}}customElements.define("task-item-form",n);class i extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.styleElement=document.createElement("style"),this.styleElement.innerText="\n      .container {\n        margin: 1em;\n        font-family: Roboto, sans-serif;\n        border: 1px solid #aaa;\n        border-radius: 5px;\n      }\n\n      .title {\n        text-align: center;\n      }\n    ",this.containerElement=t({element:"div",class:"container"}),this.titleElement=t({element:"h1",class:"title",innerText:"Task List"}),this.taskItemListContainerElement=t({element:"div",class:"task-item-container"}),this.taskItemFormElement=t({element:"task-item-form",class:"task-item-form"}),this.shadow.append(this.styleElement,this.containerElement),this.containerElement.append(this.titleElement,this.taskItemListContainerElement,this.taskItemFormElement)}}customElements.define("task-list",i);let s=[];const o=t({element:"task-list"}),r=Array.from(o.shadowRoot.childNodes).find((t=>"container"===t.getAttribute("class"))),a=r.querySelector(".task-item-container"),l=r.querySelector(".task-item-form"),d=Array.from(l.shadowRoot.childNodes).find((t=>"task-form"===t.getAttribute("class"))),m=Array.from(d.querySelectorAll('.task-input[type="text"]')).reduce(((t,e)=>({...t,[e.name]:e})),{}),c=t=>{const{title:e,description:n}=t,i=s.findIndex((({title:t,description:i})=>e===t&&n===i));s.splice(i,1),window.localStorage.setItem("tasks",JSON.stringify(s)),a.querySelector(`[title="${e}"][description="${n}"]`).remove()},p=e=>{const{title:n,description:i}=e,s=t({element:"task-item",title:n,description:i}),o=(t=>{const e=Array.from(Array.from(t.shadowRoot.childNodes).find((t=>"container"===t.getAttribute("class"))).querySelectorAll(".task-button"));return{finish:e.find((t=>"finish-button"===t.getAttribute("id"))),delete:e.find((t=>"delete-button"===t.getAttribute("id"))),edit:e.find((t=>"edit-button"===t.getAttribute("id")))}})(s);o.finish.addEventListener("click",(()=>c(e))),o.delete.addEventListener("click",(()=>c(e))),o.edit.addEventListener("click",(()=>window.alert("editting task!"))),a.append(s)},u=t=>{t.preventDefault();const{title:{value:e},description:{value:n}}=m,[i,o]=[e.trim(),n.trim()];var r;i&&o?s.some((({title:t,description:e})=>i===t&&o===e))?console.error({title:i,description:o}," already defined"):(r={title:i,description:o},s.push(r),window.localStorage.setItem("tasks",JSON.stringify(s)),p(r),Object.values(m).forEach((t=>({...t,value:""})))):console.error("task fields cannot be empty")};window.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(o),d.addEventListener("submit",u),window.localStorage.getItem("tasks")||window.localStorage.setItem("tasks",JSON.stringify([])),s=JSON.parse(window.localStorage.getItem("tasks")),s.forEach((t=>p(t)))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ncm91cDYvLi9zcmMvdXRpbHMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZ3JvdXA2Ly4vc3JjL2NvbXBvbmVudHMvdGFzay1pdGVtLmpzIiwid2VicGFjazovL2dyb3VwNi8uL3NyYy9jb21wb25lbnRzL3Rhc2staXRlbS1mb3JtLmpzIiwid2VicGFjazovL2dyb3VwNi8uL3NyYy9jb21wb25lbnRzL3Rhc2stbGlzdC5qcyIsIndlYnBhY2s6Ly9ncm91cDYvLi9zcmMvc2NyaXB0cy90YXNrLWxpc3QuanMiLCJ3ZWJwYWNrOi8vZ3JvdXA2Ly4vc3JjL3NjcmlwdHMvaW5kZXguanMiXSwibmFtZXMiOlsiY3JlYXRlRWxlbWVudCIsImVsZW1lbnQiLCJlbGVtZW50VHlwZSIsImF0dHJpYnV0ZXMiLCJkb2N1bWVudCIsIk9iamVjdCIsImVudHJpZXMiLCJmb3JFYWNoIiwia2V5IiwidmFsdWUiLCJzZXRBdHRyaWJ1dGUiLCJUYXNrSXRlbSIsIkhUTUxFbGVtZW50Iiwic3VwZXIiLCJ0aGlzIiwic2hhZG93IiwiYXR0YWNoU2hhZG93IiwibW9kZSIsInN0eWxlRWxlbWVudCIsImlubmVyVGV4dCIsIm1hdGVyaWFsSWNvbkxpbmtFbGVtZW50IiwicmVsIiwiaHJlZiIsImNvbnRhaW5lckVsZW1lbnQiLCJjbGFzcyIsInRpdGxlRWxlbWVudCIsImRlc2NyaXB0aW9uRWxlbWVudCIsImVkaXRUYXNrQnV0dG9uIiwiaWQiLCJmaW5pc2hUYXNrQnV0dG9uIiwiZGVsZXRlVGFza0J1dHRvbiIsImFwcGVuZCIsIm5hbWUiLCJvbGRWYWx1ZSIsIm5ld1ZhbHVlIiwiY3VzdG9tRWxlbWVudHMiLCJkZWZpbmUiLCJUYXNrSXRlbUZvcm0iLCJ0aXRsZUlucHV0TGFiZWwiLCJmb3IiLCJ0aXRsZUlucHV0RWxlbWVudCIsInR5cGUiLCJwbGFjZWhvbGRlciIsImRlc2NyaXB0aW9uSW5wdXRMYWJlbCIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50Iiwic3VibWl0SW5wdXRFbGVtZW50IiwiVGFza0xpc3QiLCJ0YXNrSXRlbUxpc3RDb250YWluZXJFbGVtZW50IiwidGFza0l0ZW1Gb3JtRWxlbWVudCIsInRhc2tzIiwidGFza0xpc3QiLCJ0YXNrTGlzdENvbnRhaW5lciIsIkFycmF5IiwiZnJvbSIsInNoYWRvd1Jvb3QiLCJjaGlsZE5vZGVzIiwiZmluZCIsImVsZW0iLCJnZXRBdHRyaWJ1dGUiLCJ0YXNrTGlzdEl0ZW1Db250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwidGFza0l0ZW1Gb3JtIiwidGFza0l0ZW1Gb3JtQ29udGFpbmVyIiwidGFza0l0ZW1Gb3JtSW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsInJlZHVjZSIsImFjYyIsImRlbGV0ZVRhc2siLCJ0YXNrVG9EZWxldGUiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwidGFza0luZGV4IiwiZmluZEluZGV4IiwidCIsImQiLCJzcGxpY2UiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsInJlbW92ZSIsImFkZFRhc2tUb0RvbSIsIm5ld1Rhc2siLCJ0YXNrSXRlbSIsImJ1dHRvbnMiLCJ0YXNrIiwiZmluaXNoIiwiYnRuIiwiZGVsZXRlIiwiZWRpdCIsImdldFRhc2tJdGVtQnV0dG9ucyIsImFkZEV2ZW50TGlzdGVuZXIiLCJhbGVydCIsImhhbmRsZVRhc2tGb3JtU3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwidHJpbW1lZFRpdGxlIiwidHJpbW1lZERlc2NyaXB0aW9uIiwidHJpbSIsInNvbWUiLCJjb25zb2xlIiwiZXJyb3IiLCJwdXNoIiwidmFsdWVzIiwiaW5wdXQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJnZXRJdGVtIiwicGFyc2UiXSwibWFwcGluZ3MiOiJtQkFNQSxNQUFNQSxFQUFnQixFQUFHQyxRQUFTQyxLQUFnQkMsTUFDaEQsTUFBTUYsRUFBVUcsU0FBU0osY0FBY0UsR0FZdkMsT0FUQUcsT0FBT0MsUUFBUUgsR0FBWUksU0FBUSxFQUFFQyxFQUFLQyxNQUM1QixjQUFSRCxHQUErQixjQUFSQSxFQUV6QlAsRUFBUU8sR0FBT0MsRUFFZlIsRUFBUVMsYUFBYUYsRUFBS0MsTUFJdkJSLEdDakJULE1BQU1VLFVBQWlCQyxZQUNyQixnQ0FDRSxNQUFPLENBQUMsUUFBUyxlQUduQixjQUNFQyxRQUdBQyxLQUFLQyxPQUFTRCxLQUFLRSxhQUFhLENBQUVDLEtBQU0sU0FFeENILEtBQUtJLGFBQWVkLFNBQVNKLGNBQWMsU0FDM0NjLEtBQUtJLGFBQWFDLFVBQVksMDlCQXFEOUJMLEtBQUtNLHdCQUEwQnBCLEVBQWMsQ0FDM0NDLFFBQVMsT0FDVG9CLElBQUssYUFDTEMsS0FBTSw0REFHUlIsS0FBS1MsaUJBQW1CdkIsRUFBYyxDQUNwQ0MsUUFBUyxNQUNUdUIsTUFBTyxjQUVUVixLQUFLVyxhQUFlekIsRUFBYyxDQUNoQ0MsUUFBUyxLQUNUdUIsTUFBTyxVQUVUVixLQUFLWSxtQkFBcUIxQixFQUFjLENBQ3RDQyxRQUFTLEtBQ1R1QixNQUFPLGdCQUdUVixLQUFLYSxlQUFpQjNCLEVBQWMsQ0FDbENDLFFBQVMsT0FDVHVCLE1BQU8sNkJBQ1BJLEdBQUksY0FDSlQsVUFBVyxTQUdiTCxLQUFLZSxpQkFBbUI3QixFQUFjLENBQ3BDQyxRQUFTLE9BQ1R1QixNQUFPLDZCQUNQSSxHQUFJLGdCQUNKVCxVQUFXLFNBR2JMLEtBQUtnQixpQkFBbUI5QixFQUFjLENBQ3BDQyxRQUFTLE9BQ1R1QixNQUFPLDZCQUNQSSxHQUFJLGdCQUNKVCxVQUFXLFdBR2JMLEtBQUtDLE9BQU9nQixPQUNWakIsS0FBS00sd0JBQ0xOLEtBQUtJLGFBQ0xKLEtBQUtTLGtCQUVQVCxLQUFLUyxpQkFBaUJRLE9BQ3BCakIsS0FBS1csYUFDTFgsS0FBS1ksbUJBQ0xaLEtBQUthLGVBQ0xiLEtBQUtlLGlCQUNMZixLQUFLZ0Isa0JBSVQseUJBQXlCRSxFQUFNQyxFQUFVQyxHQUN2QyxPQUFRRixHQUNOLElBQUssUUFDSGxCLEtBQUtXLGFBQWFOLFVBQVllLEVBQzlCLE1BQ0YsSUFBSyxjQUNIcEIsS0FBS1ksbUJBQW1CUCxVQUFZZSxJQU81Q0MsZUFBZUMsT0FBTyxZQUFhekIsR0NwSW5DLE1BQU0wQixVQUFxQnpCLFlBQ3pCLGNBQ0VDLFFBRUFDLEtBQUtDLE9BQVNELEtBQUtFLGFBQWEsQ0FBRUMsS0FBTSxTQUV4Q0gsS0FBS0ksYUFBZWQsU0FBU0osY0FBYyxTQUMzQ2MsS0FBS0ksYUFBYUMsVUFBWSxpZ0NBK0M5QkwsS0FBS1MsaUJBQW1CdkIsRUFBYyxDQUNwQ0MsUUFBUyxPQUNUdUIsTUFBTyxjQUdUVixLQUFLd0IsZ0JBQWtCdEMsRUFBYyxDQUNuQ0MsUUFBUyxRQUNUc0MsSUFBSyxjQUNMcEIsVUFBVyxVQUdiTCxLQUFLMEIsa0JBQW9CeEMsRUFBYyxDQUNyQ0MsUUFBUyxRQUNUdUIsTUFBTyxhQUNQSSxHQUFJLGNBQ0phLEtBQU0sT0FDTlQsS0FBTSxRQUNOVSxZQUFhLGVBR2Y1QixLQUFLNkIsc0JBQXdCM0MsRUFBYyxDQUN6Q0MsUUFBUyxRQUNUc0MsSUFBSyxvQkFDTHBCLFVBQVcsZ0JBR2JMLEtBQUs4Qix3QkFBMEI1QyxFQUFjLENBQzNDQyxRQUFTLFFBQ1R1QixNQUFPLGFBQ1BJLEdBQUksb0JBQ0phLEtBQU0sT0FDTlQsS0FBTSxjQUNOVSxZQUFhLHFCQUdmNUIsS0FBSytCLG1CQUFxQjdDLEVBQWMsQ0FDdENDLFFBQVMsUUFDVHVCLE1BQU8sYUFDUEksR0FBSSxlQUNKYSxLQUFNLFNBQ05oQyxNQUFPLFFBR1RLLEtBQUtDLE9BQU9nQixPQUFPakIsS0FBS0ksYUFBY0osS0FBS1Msa0JBQzNDVCxLQUFLUyxpQkFBaUJRLE9BQ3BCakIsS0FBS3dCLGdCQUNMeEIsS0FBSzBCLGtCQUNMMUIsS0FBSzZCLHNCQUNMN0IsS0FBSzhCLHdCQUNMOUIsS0FBSytCLHFCQUtYVixlQUFlQyxPQUFPLGlCQUFrQkMsR0M1R3hDLE1BQU1TLFVBQWlCbEMsWUFDckIsY0FDRUMsUUFFQUMsS0FBS0MsT0FBU0QsS0FBS0UsYUFBYSxDQUFFQyxLQUFNLFNBQ3hDSCxLQUFLSSxhQUFlZCxTQUFTSixjQUFjLFNBQzNDYyxLQUFLSSxhQUFhQyxVQUFZLDROQWE5QkwsS0FBS1MsaUJBQW1CdkIsRUFBYyxDQUNwQ0MsUUFBUyxNQUNUdUIsTUFBTyxjQUdUVixLQUFLVyxhQUFlekIsRUFBYyxDQUNoQ0MsUUFBUyxLQUNUdUIsTUFBTyxRQUNQTCxVQUFXLGNBR2JMLEtBQUtpQyw2QkFBK0IvQyxFQUFjLENBQ2hEQyxRQUFTLE1BQ1R1QixNQUFPLHdCQUdUVixLQUFLa0Msb0JBQXNCaEQsRUFBYyxDQUN2Q0MsUUFBUyxpQkFDVHVCLE1BQU8sbUJBR1RWLEtBQUtDLE9BQU9nQixPQUFPakIsS0FBS0ksYUFBY0osS0FBS1Msa0JBQzNDVCxLQUFLUyxpQkFBaUJRLE9BQ3BCakIsS0FBS1csYUFDTFgsS0FBS2lDLDZCQUNMakMsS0FBS2tDLHNCQUtYYixlQUFlQyxPQUFPLFlBQWFVLEdDbENuQyxJQUFJRyxFQUFRLEdBS1osTUFBTUMsRUFBV2xELEVBQWMsQ0FDN0JDLFFBQVMsY0FFTGtELEVBQW9CQyxNQUFNQyxLQUFLSCxFQUFTSSxXQUFXQyxZQUFZQyxNQUNsRUMsR0FBd0MsY0FBL0JBLEVBQUtDLGFBQWEsV0FFeEJDLEVBQXdCUixFQUFrQlMsY0FDOUMsd0JBTUlDLEVBQWVWLEVBQWtCUyxjQUFjLG1CQUMvQ0UsRUFBd0JWLE1BQU1DLEtBQ2xDUSxFQUFhUCxXQUFXQyxZQUN4QkMsTUFBTUMsR0FBd0MsY0FBL0JBLEVBQUtDLGFBQWEsV0FDN0JLLEVBQXFCWCxNQUFNQyxLQUMvQlMsRUFBc0JFLGlCQUFpQiw2QkFDdkNDLFFBQU8sQ0FBQ0MsRUFBS1QsS0FBUyxJQUFNUyxFQUFLLENBQUNULEVBQUt6QixNQUFPeUIsS0FBUyxJQXlCbkRVLEVBQWNDLElBQ2xCLE1BQU0sTUFBRUMsRUFBSyxZQUFFQyxHQUFnQkYsRUFHekJHLEVBQVl0QixFQUFNdUIsV0FDdEIsRUFBR0gsTUFBT0ksRUFBR0gsWUFBYUksS0FBUUwsSUFBVUksR0FBS0gsSUFBZ0JJLElBRW5FekIsRUFBTTBCLE9BQU9KLEVBQVcsR0FDeEJLLE9BQU9DLGFBQWFDLFFBQVEsUUFBU0MsS0FBS0MsVUFBVS9CLElBR25DVSxFQUFzQkMsY0FDckMsV0FBV1Msb0JBQXdCQyxPQUU1QlcsVUFPTEMsRUFBZ0JDLElBQ3BCLE1BQU0sTUFBRWQsRUFBSyxZQUFFQyxHQUFnQmEsRUFHekJDLEVBQVdwRixFQUFjLENBQzdCQyxRQUFTLFlBQ1RvRSxRQUNBQyxnQkFFSWUsRUFoRG1CLENBQUNDLElBQzFCLE1BQU1ELEVBQVVqQyxNQUFNQyxLQUNwQkQsTUFBTUMsS0FBS2lDLEVBQUtoQyxXQUFXQyxZQUN4QkMsTUFBTUMsR0FBd0MsY0FBL0JBLEVBQUtDLGFBQWEsV0FDakNNLGlCQUFpQixpQkFHdEIsTUFBTyxDQUNMdUIsT0FBUUYsRUFBUTdCLE1BQU1nQyxHQUFtQyxrQkFBM0JBLEVBQUk5QixhQUFhLFFBQy9DK0IsT0FBUUosRUFBUTdCLE1BQU1nQyxHQUFtQyxrQkFBM0JBLEVBQUk5QixhQUFhLFFBQy9DZ0MsS0FBTUwsRUFBUTdCLE1BQU1nQyxHQUFtQyxnQkFBM0JBLEVBQUk5QixhQUFhLFVBc0MvQmlDLENBQW1CUCxHQUNuQ0MsRUFBUUUsT0FBT0ssaUJBQWlCLFNBQVMsSUFBTXpCLEVBQVdnQixLQUMxREUsRUFBUUksT0FBT0csaUJBQWlCLFNBQVMsSUFBTXpCLEVBQVdnQixLQUMxREUsRUFBUUssS0FBS0UsaUJBQWlCLFNBQVMsSUFBTWhCLE9BQU9pQixNQUFNLG9CQUMxRGxDLEVBQXNCNUIsT0FBT3FELElBbUR6QlUsRUFBd0JDLElBQzVCQSxFQUFFQyxpQkFFRixNQUNFM0IsT0FBUzVELE1BQU80RCxHQUNoQkMsYUFBZTdELE1BQU82RCxJQUNwQlAsR0FDR2tDLEVBQWNDLEdBQXNCLENBQUM3QixFQUFNOEIsT0FBUTdCLEVBQVk2QixRQW5EeEQsSUFBQ2hCLEVBc0RWYyxHQUFpQkMsRUFPcEJqRCxFQUFNbUQsTUFDSixFQUFHL0IsTUFBT0ksRUFBR0gsWUFBYUksS0FDeEJ1QixJQUFpQnhCLEdBQUt5QixJQUF1QnhCLElBR2pEMkIsUUFBUUMsTUFDTixDQUFFakMsTUFBTzRCLEVBQWMzQixZQUFhNEIsR0FDcEMscUJBcEVXZixFQXlFUCxDQUFFZCxNQUFPNEIsRUFBYzNCLFlBQWE0QixHQXZFNUNqRCxFQUFNc0QsS0FBS3BCLEdBQ1hQLE9BQU9DLGFBQWFDLFFBQVEsUUFBU0MsS0FBS0MsVUFBVS9CLElBQ3BEaUMsRUFBYUMsR0FzRWI5RSxPQUFPbUcsT0FBT3pDLEdBQW9CeEQsU0FBU2tHLElBQVUsSUFDaERBLEVBQ0hoRyxNQUFPLFFBckJQNEYsUUFBUUMsTUFBTSxnQ0M1SmxCMUIsT0FBT2dCLGlCQUFpQixvQkFBb0IsS0FDdkJ4RixTQUFTc0csS0QwTFhDLFlBQVl6RCxHQUM3QlksRUFBc0I4QixpQkFBaUIsU0FBVUUsR0FHNUNsQixPQUFPQyxhQUFhK0IsUUFBUSxVQUMvQmhDLE9BQU9DLGFBQWFDLFFBQVEsUUFBU0MsS0FBS0MsVUFBVSxLQUV0RC9CLEVBQVE4QixLQUFLOEIsTUFBTWpDLE9BQU9DLGFBQWErQixRQUFRLFVBQy9DM0QsRUFBTTFDLFNBQVMrRSxHQUFTSixFQUFhSSxTIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZXMgYW4gSFRNTEVsZW1lbnQgYW5kIHNldCBpdHMgYXR0cmlidXRlc1xuICogQ3JlYXRlZCB0byByZWR1Y2UgYm9pbGVycGxhdGUgZnJvbSBlbGVtZW50IGNyZWF0aW9uXG4gKiBAcGFyYW0ge3tzdHJpbmc6IHN0cmluZ319IHByb3BzIC0gb2JqIGNvbnRhaW5pbmcgZWxlbWVudCBuYW1lIGFuZCBhdHRyaWJ1dGVcbiAqIEByZXR1cm4gZWxlbWVudCAtIG5ldyBIVE1MRWxlbWVudCBjcmVhdGVkXG4gKi9cbmNvbnN0IGNyZWF0ZUVsZW1lbnQgPSAoeyBlbGVtZW50OiBlbGVtZW50VHlwZSwgLi4uYXR0cmlidXRlcyB9KSA9PiB7XG4gIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGVsZW1lbnRUeXBlKTsgLy8gY3JlYXRlIGVsZW1lbnRcblxuICAvLyBzZXQgYXR0cmlidXRlc1xuICBPYmplY3QuZW50cmllcyhhdHRyaWJ1dGVzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICBpZiAoa2V5ID09PSAnaW5uZXJUZXh0JyB8fCBrZXkgPT09ICdpbm5lckhUTUwnKSB7XG4gICAgICAvLyBzb21lIHByb3BzIGxpa2UgaW5uZXJIVE1MIGFyZSBub3QgYXR0cmlidXRlcyBhbmQgc2hvdWxkIGJlIGFzc2lnbmVkIGRpcmVjdGx5XG4gICAgICBlbGVtZW50W2tleV0gPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gZWxlbWVudDtcbn07XG5cbmV4cG9ydCB7IGNyZWF0ZUVsZW1lbnQgfTtcbiIsImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tICcuLi91dGlscyc7XG5cbmNsYXNzIFRhc2tJdGVtIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBzdGF0aWMgZ2V0IG9ic2VydmVkQXR0cmlidXRlcygpIHtcbiAgICByZXR1cm4gWyd0aXRsZScsICdkZXNjcmlwdGlvbiddO1xuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcblxuICAgIC8vIGNyZWF0ZSBzaGFkb3cgcm9vdFxuICAgIHRoaXMuc2hhZG93ID0gdGhpcy5hdHRhY2hTaGFkb3coeyBtb2RlOiAnb3BlbicgfSk7XG5cbiAgICB0aGlzLnN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgdGhpcy5zdHlsZUVsZW1lbnQuaW5uZXJUZXh0ID0gYFxuICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgIGJhY2tncm91bmQ6IGxpZ2h0Ymx1ZTtcbiAgICAgICAgZm9udC1mYW1pbHk6IFJvYm90bywgc2Fucy1zZXJpZjtcbiAgICAgICAgbWFyZ2luOiAxZW07XG4gICAgICAgIHBhZGRpbmc6IDAuNWVtO1xuICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICAgIH1cblxuICAgICAgLnRpdGxlIHtcbiAgICAgICAgZm9udC1zaXplOiAxLjI1cmVtO1xuICAgICAgfVxuXG4gICAgICAuZGVzY3JpcHRpb24ge1xuICAgICAgICBmb250LXNpemU6IDFyZW07XG4gICAgICAgIGNvbG9yOiBkYXJrZ3JheTtcbiAgICAgIH1cblxuICAgICAgLnRhc2stYnV0dG9uIHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICBwYWRkaW5nOiAwLjVlbTtcbiAgICAgICAgY29sb3I6IHJnYmEoNTEsIDUxLCA1MSwgMC41KTtcbiAgICAgIH1cblxuICAgICAgLnRhc2stYnV0dG9uOmhvdmVyIHtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDIzOCwgMjM4LCAyMzgsIDAuNSk7XG4gICAgICAgIGNvbG9yOiByZ2JhKDUxLCA1MSwgNTEsIDEpO1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICB9XG5cbiAgICAgICNlZGl0LWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIC5jb250YWluZXI6aG92ZXIgPiAjZWRpdC1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBpbml0aWFsO1xuICAgICAgICB0b3A6IDA7XG4gICAgICAgIHJpZ2h0OiAwO1xuICAgICAgfVxuXG4gICAgICAjZmluaXNoLWJ1dHRvbiB7XG4gICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgcmlnaHQ6IDEuNWVtO1xuICAgICAgfVxuXG4gICAgICAjZGVsZXRlLWJ1dHRvbiB7XG4gICAgICAgIGJvdHRvbTogMDtcbiAgICAgICAgcmlnaHQ6IDA7XG4gICAgICB9XG4gICAgYDtcblxuICAgIHRoaXMubWF0ZXJpYWxJY29uTGlua0VsZW1lbnQgPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIGVsZW1lbnQ6ICdsaW5rJyxcbiAgICAgIHJlbDogJ3N0eWxlc2hlZXQnLFxuICAgICAgaHJlZjogJ2h0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vaWNvbj9mYW1pbHk9TWF0ZXJpYWwrSWNvbnMnLFxuICAgIH0pO1xuXG4gICAgdGhpcy5jb250YWluZXJFbGVtZW50ID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnZGl2JyxcbiAgICAgIGNsYXNzOiAnY29udGFpbmVyJyxcbiAgICB9KTtcbiAgICB0aGlzLnRpdGxlRWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgZWxlbWVudDogJ2gxJyxcbiAgICAgIGNsYXNzOiAndGl0bGUnLFxuICAgIH0pO1xuICAgIHRoaXMuZGVzY3JpcHRpb25FbGVtZW50ID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnaDInLFxuICAgICAgY2xhc3M6ICdkZXNjcmlwdGlvbicsXG4gICAgfSk7XG5cbiAgICB0aGlzLmVkaXRUYXNrQnV0dG9uID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnc3BhbicsXG4gICAgICBjbGFzczogJ21hdGVyaWFsLWljb25zIHRhc2stYnV0dG9uJyxcbiAgICAgIGlkOiAnZWRpdC1idXR0b24nLFxuICAgICAgaW5uZXJUZXh0OiAnbW9kZScsXG4gICAgfSk7XG5cbiAgICB0aGlzLmZpbmlzaFRhc2tCdXR0b24gPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIGVsZW1lbnQ6ICdzcGFuJyxcbiAgICAgIGNsYXNzOiAnbWF0ZXJpYWwtaWNvbnMgdGFzay1idXR0b24nLFxuICAgICAgaWQ6ICdmaW5pc2gtYnV0dG9uJyxcbiAgICAgIGlubmVyVGV4dDogJ2RvbmUnLFxuICAgIH0pO1xuXG4gICAgdGhpcy5kZWxldGVUYXNrQnV0dG9uID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnc3BhbicsXG4gICAgICBjbGFzczogJ21hdGVyaWFsLWljb25zIHRhc2stYnV0dG9uJyxcbiAgICAgIGlkOiAnZGVsZXRlLWJ1dHRvbicsXG4gICAgICBpbm5lclRleHQ6ICdkZWxldGUnLFxuICAgIH0pO1xuXG4gICAgdGhpcy5zaGFkb3cuYXBwZW5kKFxuICAgICAgdGhpcy5tYXRlcmlhbEljb25MaW5rRWxlbWVudCxcbiAgICAgIHRoaXMuc3R5bGVFbGVtZW50LFxuICAgICAgdGhpcy5jb250YWluZXJFbGVtZW50LFxuICAgICk7XG4gICAgdGhpcy5jb250YWluZXJFbGVtZW50LmFwcGVuZChcbiAgICAgIHRoaXMudGl0bGVFbGVtZW50LFxuICAgICAgdGhpcy5kZXNjcmlwdGlvbkVsZW1lbnQsXG4gICAgICB0aGlzLmVkaXRUYXNrQnV0dG9uLFxuICAgICAgdGhpcy5maW5pc2hUYXNrQnV0dG9uLFxuICAgICAgdGhpcy5kZWxldGVUYXNrQnV0dG9uLFxuICAgICk7XG4gIH1cblxuICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2sobmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICBjYXNlICd0aXRsZSc6XG4gICAgICAgIHRoaXMudGl0bGVFbGVtZW50LmlubmVyVGV4dCA9IG5ld1ZhbHVlO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2Rlc2NyaXB0aW9uJzpcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbkVsZW1lbnQuaW5uZXJUZXh0ID0gbmV3VmFsdWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICB9XG4gIH1cbn1cblxuY3VzdG9tRWxlbWVudHMuZGVmaW5lKCd0YXNrLWl0ZW0nLCBUYXNrSXRlbSk7XG4iLCJpbXBvcnQgeyBjcmVhdGVFbGVtZW50IH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5jbGFzcyBUYXNrSXRlbUZvcm0gZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB0aGlzLnNoYWRvdyA9IHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xuXG4gICAgdGhpcy5zdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICAgIHRoaXMuc3R5bGVFbGVtZW50LmlubmVyVGV4dCA9IGBcbiAgICAgIC50YXNrLWZvcm0ge1xuICAgICAgICBtYXJnaW46IDFlbTtcbiAgICAgICAgcGFkZGluZzogMWVtIDIwJTtcbiAgICAgICAgZm9udC1mYW1pbHk6IFJvYm90bywgc2Fucy1zZXJpZjtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgfVxuXG4gICAgICAudGFzay1pbnB1dFt0eXBlPSd0ZXh0J10ge1xuICAgICAgICBtYXJnaW4tYm90dG9tOiAxZW07XG4gICAgICAgIHBhZGRpbmc6IDAuNzVlbTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjNzc3O1xuICAgICAgICBmb250LXNpemU6IDAuOXJlbTtcbiAgICAgICAgY29sb3I6ICM0NDQ7XG4gICAgICB9XG5cbiAgICAgIC50YXNrLWlucHV0W3R5cGU9J3RleHQnXTpmb2N1cyB7XG4gICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICMwMDc3YjY7XG4gICAgICAgIG91dGxpbmU6IG5vbmU7XG4gICAgICAgIGJveC1zaGFkb3c6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIC50YXNrLWlucHV0W3R5cGU9J3RleHQnXTo6cGxhY2Vob2xkZXIge1xuICAgICAgICBjb2xvcjogIzc3NztcbiAgICAgIH1cblxuICAgICAgI3N1Ym1pdC1pbnB1dCB7XG4gICAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgICBtYXJnaW46IGF1dG87XG4gICAgICAgIGJhY2tncm91bmQ6IHJnYmEoNTEsIDUxLCA1MSwgMC43NSk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICAgICAgb3V0bGluZTogbm9uZTtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgICBjb2xvcjogd2hpdGU7XG4gICAgICAgIHBhZGRpbmc6IDFlbTtcbiAgICAgICAgZm9udC1zaXplOiAxcmVtO1xuICAgICAgfVxuXG4gICAgICAjc3VibWl0LWlucHV0OmhvdmVyIHtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDUxLCA1MSwgNTEsIDEpO1xuICAgICAgfVxuICAgIGA7XG5cbiAgICB0aGlzLmNvbnRhaW5lckVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIGVsZW1lbnQ6ICdmb3JtJyxcbiAgICAgIGNsYXNzOiAndGFzay1mb3JtJyxcbiAgICB9KTtcblxuICAgIHRoaXMudGl0bGVJbnB1dExhYmVsID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnbGFiZWwnLFxuICAgICAgZm9yOiAndGl0bGUtaW5wdXQnLFxuICAgICAgaW5uZXJUZXh0OiAnVGl0bGUnLFxuICAgIH0pO1xuXG4gICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgZWxlbWVudDogJ2lucHV0JyxcbiAgICAgIGNsYXNzOiAndGFzay1pbnB1dCcsXG4gICAgICBpZDogJ3RpdGxlLWlucHV0JyxcbiAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgIG5hbWU6ICd0aXRsZScsXG4gICAgICBwbGFjZWhvbGRlcjogJ3Rhc2sgdGl0bGUnLFxuICAgIH0pO1xuXG4gICAgdGhpcy5kZXNjcmlwdGlvbklucHV0TGFiZWwgPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIGVsZW1lbnQ6ICdsYWJlbCcsXG4gICAgICBmb3I6ICdkZXNjcmlwdGlvbi1pbnB1dCcsXG4gICAgICBpbm5lclRleHQ6ICdEZXNjcmlwdGlvbicsXG4gICAgfSk7XG5cbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnaW5wdXQnLFxuICAgICAgY2xhc3M6ICd0YXNrLWlucHV0JyxcbiAgICAgIGlkOiAnZGVzY3JpcHRpb24taW5wdXQnLFxuICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgbmFtZTogJ2Rlc2NyaXB0aW9uJyxcbiAgICAgIHBsYWNlaG9sZGVyOiAndGFzayBkZXNjcmlwdGlvbicsXG4gICAgfSk7XG5cbiAgICB0aGlzLnN1Ym1pdElucHV0RWxlbWVudCA9IGNyZWF0ZUVsZW1lbnQoe1xuICAgICAgZWxlbWVudDogJ2lucHV0JyxcbiAgICAgIGNsYXNzOiAndGFzay1pbnB1dCcsXG4gICAgICBpZDogJ3N1Ym1pdC1pbnB1dCcsXG4gICAgICB0eXBlOiAnc3VibWl0JyxcbiAgICAgIHZhbHVlOiAnQWRkJyxcbiAgICB9KTtcblxuICAgIHRoaXMuc2hhZG93LmFwcGVuZCh0aGlzLnN0eWxlRWxlbWVudCwgdGhpcy5jb250YWluZXJFbGVtZW50KTtcbiAgICB0aGlzLmNvbnRhaW5lckVsZW1lbnQuYXBwZW5kKFxuICAgICAgdGhpcy50aXRsZUlucHV0TGFiZWwsXG4gICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LFxuICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0TGFiZWwsXG4gICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LFxuICAgICAgdGhpcy5zdWJtaXRJbnB1dEVsZW1lbnQsXG4gICAgKTtcbiAgfVxufVxuXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ3Rhc2staXRlbS1mb3JtJywgVGFza0l0ZW1Gb3JtKTtcbiIsImltcG9ydCB7IGNyZWF0ZUVsZW1lbnQgfSBmcm9tICcuLi91dGlscyc7XG5cbmNsYXNzIFRhc2tMaXN0IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5zaGFkb3cgPSB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICB0aGlzLnN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgdGhpcy5zdHlsZUVsZW1lbnQuaW5uZXJUZXh0ID0gYFxuICAgICAgLmNvbnRhaW5lciB7XG4gICAgICAgIG1hcmdpbjogMWVtO1xuICAgICAgICBmb250LWZhbWlseTogUm9ib3RvLCBzYW5zLXNlcmlmO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjYWFhO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgICB9XG5cbiAgICAgIC50aXRsZSB7XG4gICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgIH1cbiAgICBgO1xuXG4gICAgdGhpcy5jb250YWluZXJFbGVtZW50ID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnZGl2JyxcbiAgICAgIGNsYXNzOiAnY29udGFpbmVyJyxcbiAgICB9KTtcblxuICAgIHRoaXMudGl0bGVFbGVtZW50ID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnaDEnLFxuICAgICAgY2xhc3M6ICd0aXRsZScsXG4gICAgICBpbm5lclRleHQ6ICdUYXNrIExpc3QnLFxuICAgIH0pO1xuXG4gICAgdGhpcy50YXNrSXRlbUxpc3RDb250YWluZXJFbGVtZW50ID0gY3JlYXRlRWxlbWVudCh7XG4gICAgICBlbGVtZW50OiAnZGl2JyxcbiAgICAgIGNsYXNzOiAndGFzay1pdGVtLWNvbnRhaW5lcicsXG4gICAgfSk7XG5cbiAgICB0aGlzLnRhc2tJdGVtRm9ybUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50KHtcbiAgICAgIGVsZW1lbnQ6ICd0YXNrLWl0ZW0tZm9ybScsXG4gICAgICBjbGFzczogJ3Rhc2staXRlbS1mb3JtJyxcbiAgICB9KTtcblxuICAgIHRoaXMuc2hhZG93LmFwcGVuZCh0aGlzLnN0eWxlRWxlbWVudCwgdGhpcy5jb250YWluZXJFbGVtZW50KTtcbiAgICB0aGlzLmNvbnRhaW5lckVsZW1lbnQuYXBwZW5kKFxuICAgICAgdGhpcy50aXRsZUVsZW1lbnQsXG4gICAgICB0aGlzLnRhc2tJdGVtTGlzdENvbnRhaW5lckVsZW1lbnQsXG4gICAgICB0aGlzLnRhc2tJdGVtRm9ybUVsZW1lbnQsXG4gICAgKTtcbiAgfVxufVxuXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ3Rhc2stbGlzdCcsIFRhc2tMaXN0KTtcbiIsIi8qKlxuICogQGZpbGUgTWFuYWdlIHRhc2tsaXN0IGZvciBwYWdlXG4gKiBAYXV0aG9yIFNlYW4gWWVcbiAqL1xuXG4vKipcbiAqIEEgdGFzayBvYmplY3QgY29udGFpbmluZyBhIHRpdGxlIGFuZCBkZXNjcmlwdGlvblxuICogQHR5cGVkZWYge09iamVjdH0gVGFza1xuICogQHByb3BlcnR5IHtzdHJpbmd9IHRpdGxlICAgICAgIC0gdGl0bGUgb2YgdGhlIHRhc2tcbiAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBkZXNjcmlwdGlvbiAtIGRlc2NyaXB0aW9uIG9mIHRoZSB0YXNrXG4gKi9cblxuaW1wb3J0IHsgY3JlYXRlRWxlbWVudCB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCAnLi4vY29tcG9uZW50cy90YXNrLWl0ZW0nO1xuaW1wb3J0ICcuLi9jb21wb25lbnRzL3Rhc2staXRlbS1mb3JtJztcbmltcG9ydCAnLi4vY29tcG9uZW50cy90YXNrLWxpc3QnO1xuXG5sZXQgdGFza3MgPSBbXTtcblxuLy8gdGFzay1saXN0IGVsZW1lbnRcbi8vIHRhc2stbGlzdCBjb250YWluZXIgZWxlbWVudFxuLy8gY29udGFpbmVyIGVsZW1lbnQgZm9yIHRhc2stbGlzdC1pdGVtXG5jb25zdCB0YXNrTGlzdCA9IGNyZWF0ZUVsZW1lbnQoe1xuICBlbGVtZW50OiAndGFzay1saXN0Jyxcbn0pO1xuY29uc3QgdGFza0xpc3RDb250YWluZXIgPSBBcnJheS5mcm9tKHRhc2tMaXN0LnNoYWRvd1Jvb3QuY2hpbGROb2RlcykuZmluZChcbiAgKGVsZW0pID0+IGVsZW0uZ2V0QXR0cmlidXRlKCdjbGFzcycpID09PSAnY29udGFpbmVyJyxcbik7XG5jb25zdCB0YXNrTGlzdEl0ZW1Db250YWluZXIgPSB0YXNrTGlzdENvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuICAnLnRhc2staXRlbS1jb250YWluZXInLFxuKTtcblxuLy8gdGFzay1pdGVtLWZvcm0gZWxlbWVudFxuLy8gdGFzay1pdGVtLWZvcm0gY29udGFpbmVyIGVsZW1lbnRcbi8vIHRhc2staXRlbS1mb3JtIHRleHQgaW5wdXQgZWxlbWVudHNcbmNvbnN0IHRhc2tJdGVtRm9ybSA9IHRhc2tMaXN0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy50YXNrLWl0ZW0tZm9ybScpO1xuY29uc3QgdGFza0l0ZW1Gb3JtQ29udGFpbmVyID0gQXJyYXkuZnJvbShcbiAgdGFza0l0ZW1Gb3JtLnNoYWRvd1Jvb3QuY2hpbGROb2RlcyxcbikuZmluZCgoZWxlbSkgPT4gZWxlbS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgPT09ICd0YXNrLWZvcm0nKTtcbmNvbnN0IHRhc2tJdGVtRm9ybUlucHV0cyA9IEFycmF5LmZyb20oXG4gIHRhc2tJdGVtRm9ybUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1pbnB1dFt0eXBlPVwidGV4dFwiXScpLFxuKS5yZWR1Y2UoKGFjYywgZWxlbSkgPT4gKHsgLi4uYWNjLCBbZWxlbS5uYW1lXTogZWxlbSB9KSwge30pO1xuXG4vKipcbiAqIEdldCBidXR0b24gZWxlbWVudHMgZnJvbSB0YXNrLWl0ZW0gZWxlbWVudFxuICogQHBhcmFtIHtUYXNrfSB0YXNrIC0gdGFzay1pdGVtIGVsZW1lbnRcbiAqIEByZXR1cm4ge3tmaW5pc2g6IEhUTUxCdXR0b25FbGVtZW50LCBkZWxldGU6IEhUTUxCdXR0b25FbGVtZW50LCBlZGl0OiBIVE1MQnV0dG9uRWxlbWVudH19IC0gYnV0dG9uIGVsZW1lbnRzIG9iamVjdFxuICovXG5jb25zdCBnZXRUYXNrSXRlbUJ1dHRvbnMgPSAodGFzaykgPT4ge1xuICBjb25zdCBidXR0b25zID0gQXJyYXkuZnJvbShcbiAgICBBcnJheS5mcm9tKHRhc2suc2hhZG93Um9vdC5jaGlsZE5vZGVzKVxuICAgICAgLmZpbmQoKGVsZW0pID0+IGVsZW0uZ2V0QXR0cmlidXRlKCdjbGFzcycpID09PSAnY29udGFpbmVyJylcbiAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKCcudGFzay1idXR0b24nKSxcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGZpbmlzaDogYnV0dG9ucy5maW5kKChidG4pID0+IGJ0bi5nZXRBdHRyaWJ1dGUoJ2lkJykgPT09ICdmaW5pc2gtYnV0dG9uJyksXG4gICAgZGVsZXRlOiBidXR0b25zLmZpbmQoKGJ0bikgPT4gYnRuLmdldEF0dHJpYnV0ZSgnaWQnKSA9PT0gJ2RlbGV0ZS1idXR0b24nKSxcbiAgICBlZGl0OiBidXR0b25zLmZpbmQoKGJ0bikgPT4gYnRuLmdldEF0dHJpYnV0ZSgnaWQnKSA9PT0gJ2VkaXQtYnV0dG9uJyksXG4gIH07XG59O1xuXG4vKipcbiAqIERlbGV0aW5nIGV4aXN0aW5nIHRhc2tcbiAqIEBwYXJhbSB7VGFza30gdGFza1RvRGVsZXRlIC0gdGFzayB0byBiZSBkZWxldGVkXG4gKi9cbmNvbnN0IGRlbGV0ZVRhc2sgPSAodGFza1RvRGVsZXRlKSA9PiB7XG4gIGNvbnN0IHsgdGl0bGUsIGRlc2NyaXB0aW9uIH0gPSB0YXNrVG9EZWxldGU7XG5cbiAgLy8gdXBkYXRlIGxvY2FsU3RvcmFnZVxuICBjb25zdCB0YXNrSW5kZXggPSB0YXNrcy5maW5kSW5kZXgoXG4gICAgKHsgdGl0bGU6IHQsIGRlc2NyaXB0aW9uOiBkIH0pID0+IHRpdGxlID09PSB0ICYmIGRlc2NyaXB0aW9uID09PSBkLFxuICApO1xuICB0YXNrcy5zcGxpY2UodGFza0luZGV4LCAxKTtcbiAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0YXNrcycsIEpTT04uc3RyaW5naWZ5KHRhc2tzKSk7XG5cbiAgLy8gcmVtb3ZlIHRhc2sgZnJvbSBkb21cbiAgY29uc3QgdGFza0l0ZW0gPSB0YXNrTGlzdEl0ZW1Db250YWluZXIucXVlcnlTZWxlY3RvcihcbiAgICBgW3RpdGxlPVwiJHt0aXRsZX1cIl1bZGVzY3JpcHRpb249XCIke2Rlc2NyaXB0aW9ufVwiXWAsXG4gICk7XG4gIHRhc2tJdGVtLnJlbW92ZSgpO1xufTtcblxuLyoqXG4gKiBBZGQgdGFzayBvYmplY3QgdG8gRE9NLCBhZGQgZXZlbnQgbGlzdGVuZXJzIHRvIHRhc2staXRlbVxuICogQHBhcmFtIHtUYXNrfSBuZXdUYXNrIC0gbmV3IHRhc2sgdG8gYmUgYWRkZWRcbiAqL1xuY29uc3QgYWRkVGFza1RvRG9tID0gKG5ld1Rhc2spID0+IHtcbiAgY29uc3QgeyB0aXRsZSwgZGVzY3JpcHRpb24gfSA9IG5ld1Rhc2s7XG5cbiAgLy8gYWRkIHRhc2sgdG8gZG9tXG4gIGNvbnN0IHRhc2tJdGVtID0gY3JlYXRlRWxlbWVudCh7XG4gICAgZWxlbWVudDogJ3Rhc2staXRlbScsXG4gICAgdGl0bGUsXG4gICAgZGVzY3JpcHRpb24sXG4gIH0pO1xuICBjb25zdCBidXR0b25zID0gZ2V0VGFza0l0ZW1CdXR0b25zKHRhc2tJdGVtKTtcbiAgYnV0dG9ucy5maW5pc2guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBkZWxldGVUYXNrKG5ld1Rhc2spKTtcbiAgYnV0dG9ucy5kZWxldGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBkZWxldGVUYXNrKG5ld1Rhc2spKTtcbiAgYnV0dG9ucy5lZGl0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gd2luZG93LmFsZXJ0KCdlZGl0dGluZyB0YXNrIScpKTtcbiAgdGFza0xpc3RJdGVtQ29udGFpbmVyLmFwcGVuZCh0YXNrSXRlbSk7XG59O1xuXG4vKipcbiAqIEFkZCBuZXcgdGFzayB0byBsb2NhbFN0b3JhZ2VcbiAqIEBwYXJhbSB7VGFza30gbmV3VGFzayAtIG5ldyB0YXNrIHRvIGJlIGFkZGVkXG4gKi9cbmNvbnN0IGFkZFRhc2sgPSAobmV3VGFzaykgPT4ge1xuICAvLyB1cGRhdGUgbG9jYWxTdG9yYWdlXG4gIHRhc2tzLnB1c2gobmV3VGFzayk7XG4gIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGFza3MnLCBKU09OLnN0cmluZ2lmeSh0YXNrcykpO1xuICBhZGRUYXNrVG9Eb20obmV3VGFzayk7XG59O1xuXG4vKipcbiAqIFVwZGF0ZSBleGlzdGluZyB0YXNrXG4gKiBAcGFyYW0ge1Rhc2t9IHByZXZUYXNrIC0gdGFzayB0byBiZSB1cGRhdGVkXG4gKiBAcGFyYW0ge1Rhc2t9IG5leHRUYXNrIC0gdXBkYXRlZCB0YXNrXG4gKi9cbmNvbnN0IHVwZGF0ZVRhc2sgPSAocHJldlRhc2ssIG5leHRUYXNrKSA9PiB7XG4gIGNvbnN0IHsgdGl0bGU6IHByZXZUaXRsZSwgZGVzY3JpcHRpb246IHByZXZEZXNjcmlwdGlvbiB9ID0gcHJldlRhc2s7XG4gIGNvbnN0IHsgdGl0bGU6IG5leHRUaXRsZSwgZGVzY3JpcHRpb246IG5leHREZXNjcmlwdGlvbiB9ID0gbmV4dFRhc2s7XG5cbiAgLy8gdXBkYXRlIGxvY2FsU3RvcmFnZVxuICBjb25zdCB0YXNrSW5kZXggPSB0YXNrcy5maW5kSW5kZXgoXG4gICAgKHsgdGl0bGUsIGRlc2NyaXB0aW9uIH0pID0+XG4gICAgICBwcmV2VGl0bGUgPT09IHRpdGxlICYmIHByZXZEZXNjcmlwdGlvbiA9PT0gZGVzY3JpcHRpb24sXG4gICk7XG4gIHRhc2tzW3Rhc2tJbmRleF0gPSBuZXh0VGFzaztcbiAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0YXNrcycsIEpTT04uc3RyaW5naWZ5KHRhc2tzKSk7XG5cbiAgLy8gdXBkYXRlIHRhc2sgaW4gZG9tXG4gIGNvbnN0IHRhc2tJdGVtID0gdGFza0xpc3RJdGVtQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXG4gICAgYFt0aXRsZT1cIiR7cHJldlRpdGxlfVwiXVtkZXNjcmlwdGlvbj1cIiR7cHJldkRlc2NyaXB0aW9ufVwiXWAsXG4gICk7XG4gIHRhc2tJdGVtLnNldEF0dHJpYnV0ZSgndGl0bGUnLCBuZXh0VGl0bGUpO1xuICB0YXNrSXRlbS5zZXRBdHRyaWJ1dGUoJ2Rlc2NyaXB0aW9uJywgbmV4dERlc2NyaXB0aW9uKTtcbn07XG5cbi8qKlxuICogR2V0IHRhc2tsaXN0XG4gKiBAcmV0dXJuIHtUYXNrW119IC0gY3VycmVudCBsaXN0IG9mIHRhc2tzXG4gKi9cbmNvbnN0IGdldFRhc2tzID0gKCkgPT4ge1xuICByZXR1cm4gdGFza3M7XG59O1xuXG4vKipcbiAqIEhhbmRsZSBmb3JtIHN1Ym1pc3Npb24sIHZhbGlkYXRlIGlucHV0XG4gKiBAcGFyYW0ge0V2ZW50fSBlIC0gc3VibWl0IGV2ZW50XG4gKi9cbmNvbnN0IGhhbmRsZVRhc2tGb3JtU3VibWl0ID0gKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBwcmV2ZW50IHBhZ2UgcmVsb2FkXG5cbiAgY29uc3Qge1xuICAgIHRpdGxlOiB7IHZhbHVlOiB0aXRsZSB9LFxuICAgIGRlc2NyaXB0aW9uOiB7IHZhbHVlOiBkZXNjcmlwdGlvbiB9LFxuICB9ID0gdGFza0l0ZW1Gb3JtSW5wdXRzO1xuICBjb25zdCBbdHJpbW1lZFRpdGxlLCB0cmltbWVkRGVzY3JpcHRpb25dID0gW3RpdGxlLnRyaW0oKSwgZGVzY3JpcHRpb24udHJpbSgpXTtcblxuICAvLyBjaGVjayBpZiBmaWVsZHMgYXJlIG5vbi1lbXB0eVxuICBpZiAoIXRyaW1tZWRUaXRsZSB8fCAhdHJpbW1lZERlc2NyaXB0aW9uKSB7XG4gICAgY29uc29sZS5lcnJvcigndGFzayBmaWVsZHMgY2Fubm90IGJlIGVtcHR5Jyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gY2hlY2sgaWYgdGFzayBhbHJlYWR5IGV4aXN0c1xuICBpZiAoXG4gICAgdGFza3Muc29tZShcbiAgICAgICh7IHRpdGxlOiB0LCBkZXNjcmlwdGlvbjogZCB9KSA9PlxuICAgICAgICB0cmltbWVkVGl0bGUgPT09IHQgJiYgdHJpbW1lZERlc2NyaXB0aW9uID09PSBkLFxuICAgIClcbiAgKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIHsgdGl0bGU6IHRyaW1tZWRUaXRsZSwgZGVzY3JpcHRpb246IHRyaW1tZWREZXNjcmlwdGlvbiB9LFxuICAgICAgJyBhbHJlYWR5IGRlZmluZWQnLFxuICAgICk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgYWRkVGFzayh7IHRpdGxlOiB0cmltbWVkVGl0bGUsIGRlc2NyaXB0aW9uOiB0cmltbWVkRGVzY3JpcHRpb24gfSk7XG4gIE9iamVjdC52YWx1ZXModGFza0l0ZW1Gb3JtSW5wdXRzKS5mb3JFYWNoKChpbnB1dCkgPT4gKHtcbiAgICAuLi5pbnB1dCxcbiAgICB2YWx1ZTogJycsXG4gIH0pKTtcbn07XG5cbi8qKlxuICogSW5pdGlhbGl6ZSB0YXNrbGlzdCBvbiBwYWdlXG4gKiBSZXRyaWV2ZSB0YXNrcyBmcm9tIGxvY2FsU3RvcmFnZVxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gY29udGFpbmVyRWxlbWVudCAtIGNvbnRhaW5lciBmb3IgdGFzayBsaXN0XG4gKi9cbmNvbnN0IGluaXRpYWxpemVUYXNrTGlzdCA9IChjb250YWluZXJFbGVtZW50KSA9PiB7XG4gIGNvbnRhaW5lckVsZW1lbnQuYXBwZW5kQ2hpbGQodGFza0xpc3QpO1xuICB0YXNrSXRlbUZvcm1Db250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlVGFza0Zvcm1TdWJtaXQpO1xuXG4gIC8vIHJldHJpdmUgYW5kIGFkZCB0YXNrcyBmcm9tIGxvY2FsU3RvcmFnZVxuICBpZiAoIXdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndGFza3MnKSkge1xuICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGFza3MnLCBKU09OLnN0cmluZ2lmeShbXSkpO1xuICB9XG4gIHRhc2tzID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rhc2tzJykpO1xuICB0YXNrcy5mb3JFYWNoKCh0YXNrKSA9PiBhZGRUYXNrVG9Eb20odGFzaykpO1xufTtcblxuZXhwb3J0IHsgaW5pdGlhbGl6ZVRhc2tMaXN0LCBhZGRUYXNrLCBnZXRUYXNrcywgdXBkYXRlVGFzaywgZGVsZXRlVGFzayB9O1xuIiwiLyoqXG4gKiBAZmlsZSBFbnRyeSBwb2ludCBmb3IgYXBwbGljYXRpb25cbiAqL1xuXG5pbXBvcnQgeyBpbml0aWFsaXplVGFza0xpc3QgfSBmcm9tICcuL3Rhc2stbGlzdCc7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICBpbml0aWFsaXplVGFza0xpc3QoZG9jdW1lbnQuYm9keSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=