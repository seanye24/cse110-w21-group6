<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Publisher in the publish-subscribe pattern, holds global state
 */

import {
  ACTIONS,
  DEFAULT_POMODORO_LENGTH,
  INTERVALS,
} from '../utils/constants';

const timerAudio = new Audio();
timerAudio.volume = 0.2;

// initialize session state
const sessionState = {
  session: 'inactive',
  totalSessionTime: 0,
  numberOfPomodorosCompleted: 0,
  currentTime: 0,
  currentInterval: INTERVALS.pomodoro,
  currentSelectedTask: null,
  completedTasks: [],
  pomodoroLength: 0.1 || DEFAULT_POMODORO_LENGTH, // TODO: FOR TESTING, use DEFAULT_POMODORO_LENGTH later
  shortBreakLength: 0,
  longBreakLength: 0,
  timerAudio,
};

// maps each action to a synchronous message queue of callbacks
const actionCallbacks = Object.values(ACTIONS).reduce(
  (acc, action) => ({ ...acc, [action]: [] }),
  {},
);

/**
 * Allow consumers to subscribe to session state and use callbacks to be notified of actions
 * @param {Object.&lt;string, Function>} callbacks - object that maps a state name to a callback that will be run when the state name changes
 * @return {Object.&lt;string, any>} - current session state
 */
const subscribe = (callbacks) => {
  if (typeof callbacks === 'object' &amp;&amp; callbacks !== null) {
    Object.entries(callbacks).forEach(([action, callback]) => {
      if (Object.prototype.hasOwnProperty.call(actionCallbacks, action)) {
        actionCallbacks[action].push(callback);
      }
    });
  }
  return sessionState;
};

/**
 * Process actions, update state, and call corresponding callbacks
 * @param {string} action - name of action
 * @param {any} payload - action payload
 */
const dispatch = (action, payload) => {
  switch (action) {
    case ACTIONS.changeSession:
      sessionState.session = payload;
      break;
    case ACTIONS.changeTotalSessionTime:
      sessionState.totalSessionTime = payload;
      break;
    case ACTIONS.changeCurrentTime:
      sessionState.currentTime = payload;
      break;
    case ACTIONS.changeCurrentInterval:
      sessionState.currentInterval = payload;
      break;
    case ACTIONS.changeSelectedTask:
      sessionState.currentSelectedTask = payload;
      break;
    case ACTIONS.incrementSelectedTask:
      break;
    case ACTIONS.completeSelectedTask:
      break;
    case ACTIONS.doNotCompleteSelectedTask:
      break;
    case ACTIONS.addToCompletedTasks:
      sessionState.completedTasks.push(payload);
      break;
    case ACTIONS.clearCompletedTasks:
      sessionState.completedTasks = [];
      break;
    case ACTIONS.changeNumberOfPomodoros:
      sessionState.numberOfPomodorosCompleted = payload;
      break;
    case ACTIONS.changePomodoroLength:
      sessionState.pomodoroLength = payload;
      break;
    case ACTIONS.changeShortBreakLength:
      sessionState.shortBreakLength = payload;
      break;
    case ACTIONS.changeLongBreakLength:
      sessionState.longBreakLength = payload;
      break;
    case ACTIONS.changeTimerAudio:
      sessionState.timerAudio.src = payload;
      break;
    default:
      return;
  }
  actionCallbacks[action].forEach((callback) => callback(sessionState));
};

export { subscribe, dispatch };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="PomodoroCircles.html">PomodoroCircles</a></li><li><a href="ProgressRing.html">ProgressRing</a></li><li><a href="Settings.html">Settings</a></li><li><a href="TaskItem.html">TaskItem</a></li><li><a href="TaskItemForm.html">TaskItemForm</a></li><li><a href="TaskList.html">TaskList</a></li><li><a href="Timer.html">Timer</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addTask">addTask</a></li><li><a href="global.html#addTaskToDom">addTaskToDom</a></li><li><a href="global.html#checkDuplicateTask">checkDuplicateTask</a></li><li><a href="global.html#closePopup">closePopup</a></li><li><a href="global.html#completeTask">completeTask</a></li><li><a href="global.html#createElement">createElement</a></li><li><a href="global.html#createTaskElement">createTaskElement</a></li><li><a href="global.html#createTaskSummary">createTaskSummary</a></li><li><a href="global.html#createTaskSummaryList">createTaskSummaryList</a></li><li><a href="global.html#deleteTask">deleteTask</a></li><li><a href="global.html#deselectAllTasks">deselectAllTasks</a></li><li><a href="global.html#disableTask">disableTask</a></li><li><a href="global.html#dispatch">dispatch</a></li><li><a href="global.html#endSession">endSession</a></li><li><a href="global.html#getCircleCount">getCircleCount</a></li><li><a href="global.html#getCurrentSelectedTask">getCurrentSelectedTask</a></li><li><a href="global.html#getHoursMinutesAndSeconds">getHoursMinutesAndSeconds</a></li><li><a href="global.html#getLongBreakLength">getLongBreakLength</a></li><li><a href="global.html#getMinutesAndSeconds">getMinutesAndSeconds</a></li><li><a href="global.html#getProgress">getProgress</a></li><li><a href="global.html#getRadius">getRadius</a></li><li><a href="global.html#getShortBreakLength">getShortBreakLength</a></li><li><a href="global.html#getStroke">getStroke</a></li><li><a href="global.html#getTask">getTask</a></li><li><a href="global.html#getTaskItemButtons">getTaskItemButtons</a></li><li><a href="global.html#getTasks">getTasks</a></li><li><a href="global.html#getTime">getTime</a></li><li><a href="global.html#getTimerAudio">getTimerAudio</a></li><li><a href="global.html#getTotalSessionTime">getTotalSessionTime</a></li><li><a href="global.html#handleTaskFormSubmit">handleTaskFormSubmit</a></li><li><a href="global.html#incrementTask">incrementTask</a></li><li><a href="global.html#initializeAnnouncement">initializeAnnouncement</a></li><li><a href="global.html#initializeElements">initializeElements</a></li><li><a href="global.html#initializeIntervalLengths">initializeIntervalLengths</a></li><li><a href="global.html#initializePomodoroCircles">initializePomodoroCircles</a></li><li><a href="global.html#initializePopup">initializePopup</a></li><li><a href="global.html#initializeProgressRing">initializeProgressRing</a></li><li><a href="global.html#initializeTaskList">initializeTaskList</a></li><li><a href="global.html#initializeTimer">initializeTimer</a></li><li><a href="global.html#openPopup">openPopup</a></li><li><a href="global.html#removeTaskFromDom">removeTaskFromDom</a></li><li><a href="global.html#restoreTasks">restoreTasks</a></li><li><a href="global.html#saveSettings">saveSettings</a></li><li><a href="global.html#saveTasks">saveTasks</a></li><li><a href="global.html#selectFirstTask">selectFirstTask</a></li><li><a href="global.html#selectTask">selectTask</a></li><li><a href="global.html#setAnnouncement">setAnnouncement</a></li><li><a href="global.html#setButtonVisibility">setButtonVisibility</a></li><li><a href="global.html#setCircleCount">setCircleCount</a></li><li><a href="global.html#setLongBreakLength">setLongBreakLength</a></li><li><a href="global.html#setProgress">setProgress</a></li><li><a href="global.html#setRadius">setRadius</a></li><li><a href="global.html#setShortBreakLength">setShortBreakLength</a></li><li><a href="global.html#setStroke">setStroke</a></li><li><a href="global.html#setTasklistUsability">setTasklistUsability</a></li><li><a href="global.html#setTimer">setTimer</a></li><li><a href="global.html#setTimerAudio">setTimerAudio</a></li><li><a href="global.html#startInterval">startInterval</a></li><li><a href="global.html#startSession">startSession</a></li><li><a href="global.html#subscribe">subscribe</a></li><li><a href="global.html#tick">tick</a></li><li><a href="global.html#updateClassesByInterval">updateClassesByInterval</a></li><li><a href="global.html#updateTask">updateTask</a></li><li><a href="global.html#validateBoolean">validateBoolean</a></li><li><a href="global.html#validateCircleCount">validateCircleCount</a></li><li><a href="global.html#validateContainerRadius">validateContainerRadius</a></li><li><a href="global.html#validateLength">validateLength</a></li><li><a href="global.html#validateLongBreakLength">validateLongBreakLength</a></li><li><a href="global.html#validateNumber">validateNumber</a></li><li><a href="global.html#validatePomodoro">validatePomodoro</a></li><li><a href="global.html#validateProgress">validateProgress</a></li><li><a href="global.html#validateShortBreakLength">validateShortBreakLength</a></li><li><a href="global.html#validateString">validateString</a></li><li><a href="global.html#validateTask">validateTask</a></li><li><a href="global.html#validateTime">validateTime</a></li><li><a href="global.html#validateTimerAudio">validateTimerAudio</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Mar 18 2021 22:49:21 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
